.chapter(data-title='Server Notifications and Alerts')
  .step(data-file='config/administrators.json')
    :markdown
      ## What does this thing do?

      This [Express.js](//expressjs.com/) sample application
      demonstrates how to send SMS alerts to a list of system
      administrators if something goes wrong on your server. In this
      tutorial, we'll show you the key bits of code to make this work.
      Head to the [application's
      README.md](//github.com/TwilioDevEd/server-notifications-node)
      to see how to run the application locally.

    p
      a(href="https://customers.twilio.com/178/emc/", target="_blank").
        See how EMC uses Twilio SMS to send IT alerts to 68,000 employees.

    :markdown
      Let's get started!

      ---

      **See Also:**
      * [Getting started with Express.js](//expressjs.com/starter/hello-world.html)
      * [twilio-node library](//twilio.github.io/twilio-node/)

  .step(data-file='config.js', data-highlight='23-45')
    :markdown
      ## Configure Twilio client

      In order to send messages we'll need to create a [Twilio REST
      client](//twilio.github.io/twilio-node/#quickstart), which
      requires reading our `TWILIO_ACCOUNT_SID`, `TWILIO_NUMBER`
      `TWILIO_AUTH_TOKEN` from the enviroment. We also make the
      variables available through the `config` module.

      ---

      **See Also:**
      * [twilio-node Quickstart](//twilio.github.io/twilio-node/#quickstart)
      * [Twilio REST Web Service Interface](//www.twilio.com/docs/api/rest)

  .step(data-file='config/administrators.json')
    :markdown
      ## List server admins

      Here we create a list of administrators who should be notified if a
      server error occurs.  The only essential piece of data we need is a
      `phoneNumber` for each administrator.

  .step(data-file='webapp.js', data-highlight='60-62')
    :markdown
      ## Handle all the exceptions in the application

      We will implement error handling and message delivery as a piece
      of [Express.js
      middleware](//expressjs.com/guide/using-middleware.html). We
      will make all the Twilio API calls from there.

      ---

      **See Also:**
      * [Error handling middleware](//expressjs.com/guide/using-middleware.html#middleware.error-handling)

  .step(data-file='middleware/twilioNotifications.js')
    :markdown
      ## Trigger notifications for administrator list

      In our Express middleware module, we read the admins from our JSON file
      and send alert messages to each of them with the `sendSms` method in
      `twilioClient`. We also call `next` with the error object, which will
      allow other configured error handling middleware to execute.

  .step(data-file='twilioClient.js')
    :markdown
      ## Send a text message

      There are the three parameters needed to [send an
      SMS](//twilio.github.io/twilio-node/#moreexamples)
      using the [Twilio REST
      API](//www.twilio.com/docs/api/rest): `From`, `To`, and
      `Body`. [US and Canadian phone
      numbers](//www.twilio.com/help/faq/sms/is-mms-supported-for-all-carriers-in-us-and-canada)
      can also send an image with the message.

      ---

      **See Also:**
      * [REST API Docs for Message resource](//www.twilio.com/docs/api/rest/message)
      * [Your message logs in the account portal](//www.twilio.com/user/account/log/messages)

  .step
    :markdown
      ## Where to next?

      That's it! We've just implemented an automated server notification system
      that can send you server alerts if anything goes wrong. If you're a Node.js
      developer working with Twilio, you might want to check out these other
      tutorials.

      [**Two-Factor Authentication**](//www.twilio.com/docs/howto/walkthrough/two-factor-authentication/node/express)

      Increase the security of your login system by verifying a user's mobile
      phone in addition to their password.

      [**SMS and MMS marketing notifications**](//www.twilio.com/docs/howto/walkthrough/marketing-notifications/node/express)

      SMS and MMS messages are a personal way to engage with users, offering
      a much higher open rate than e-mail and more impact than a tweet.


      ### Did this help?

      Thanks for checking out this tutorial! If you have any feedback
      to share with us, we'd love to hear it. [Contact the Twilio Developer
      Education Team](mailto:deved-oss@twilio.com) to let us know what you think.
